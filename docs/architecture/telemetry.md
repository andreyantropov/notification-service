# –¢–µ–ª–µ–º–µ—Ç—Ä–∏—è

–°–µ—Ä–≤–∏—Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø–æ–ª–Ω—É—é —Ç–µ–ª–µ–º–µ—Ç—Ä–∏—é —á–µ—Ä–µ–∑ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ, –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—é –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –±—ã—Å—Ç—Ä–æ –≤—ã—è–≤–ª—è—Ç—å —Å–±–æ–∏, –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –∂–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ.

–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ç–µ–ª–µ–º–µ—Ç—Ä–∏–∏ –æ—Å–Ω–æ–≤–∞–Ω–∞ –Ω–∞ —Ç—Ä—ë—Ö –ø—Ä–∏–Ω—Ü–∏–ø–∞—Ö:

- **–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º (`traceId`, `spanId`, `correlationId`);
- **–û—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å** ‚Äî –ª–æ–≥–∏ –Ω–µ —Ç–µ—Ä—è—é—Ç—Å—è –¥–∞–∂–µ –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏ –≤–Ω–µ—à–Ω–∏—Ö —Å–∏—Å—Ç–µ–º;
- **–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—é** ‚Äî –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –±—É–¥—É—â–µ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –ø–æ–ª–Ω—ã–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–º —Ç—Ä–µ–π—Å–∏–Ω–≥–æ–º (OpenTelemetry) –∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏.

---

## –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å–µ —Å–æ–±—ã—Ç–∏—è –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ **InfluxDB** ‚Äî –≤—Ä–µ–º–µ–Ω–Ω—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö, –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—É—é –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ª–æ–≥–æ–≤.

–§–æ—Ä–º–∞—Ç –ª–æ–≥–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É `Log`:

```ts
interface Log {
  measurement: string;
  timestamp: number; // Unix timestamp –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö
  tags: {
    /* –∏–Ω–¥–µ–∫—Å–∏—Ä—É–µ–º—ã–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ */
  };
  fields: {
    /* –¥–∞–Ω–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è */
  };
}
```

---

### Tags (–∏–Ω–¥–µ–∫—Å–∏—Ä—É–µ–º—ã–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ)

| –¢–µ–≥              | –¢–∏–ø / –ó–Ω–∞—á–µ–Ω–∏–µ                                      | –û–ø–∏—Å–∞–Ω–∏–µ                            |
| ---------------- | --------------------------------------------------- | ----------------------------------- |
| `level`          | `LogLevel` (`info`, `warning`, `error`, `critical`) | –£—Ä–æ–≤–µ–Ω—å –≤–∞–∂–Ω–æ—Å—Ç–∏ —Å–æ–±—ã—Ç–∏—è            |
| `serviceName`    | `string`                                            | –ò–º—è —Å–µ—Ä–≤–∏—Å–∞: `notification-service` |
| `serviceVersion` | `string`                                            | –í–µ—Ä—Å–∏—è —Å–µ—Ä–≤–∏—Å–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `v1.2.3`) |
| `trigger`        | `TriggerType` (`api`, `cron`, `manual`)             | –ò—Å—Ç–æ—á–Ω–∏–∫ –∏–Ω–∏—Ü–∏–∞—Ü–∏–∏ —Å–æ–±—ã—Ç–∏—è          |
| `environment`    | `EnvironmentType` (`dev`, `stage`, `prod`)          | –û–∫—Ä—É–∂–µ–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è                |
| `eventType`      | `EventType` (`bootstrap`, `shitdown` –∏ —Ç.–¥.)        | –¢–∏–ø –±–∏–∑–Ω–µ—Å-—Å–æ–±—ã—Ç–∏—è                  |
| `host`           | `string`                                            | –ò–º—è —Ö–æ—Å—Ç–∞ –∏–ª–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞            |

> üí° –í—Å–µ –ø–æ–ª—è –≤ `tags` **–∏–Ω–¥–µ–∫—Å–∏—Ä—É—é—Ç—Å—è** InfluxDB –∏ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –∏ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏.

---

### Fields (–¥–∞–Ω–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è)

| –ü–æ–ª–µ         | –¢–∏–ø / –û–ø–∏—Å–∞–Ω–∏–µ                                                                                     |
| ------------ | -------------------------------------------------------------------------------------------------- |
| `id`         | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID —Å–æ–±—ã—Ç–∏—è (UUID)                                                                       |
| `message`    | –ö—Ä–∞—Ç–∫–æ–µ —á–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ                                                                  |
| `durationMs` | –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)                                                |
| `traceId`    | ID —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–≥–æ —Ç—Ä–µ–π—Å–∞ (OpenTelemetry)                                                          |
| `spanId`     | ID —Ç–µ–∫—É—â–µ–≥–æ —ç—Ç–∞–ø–∞ –≤ —Ä–∞–º–∫–∞—Ö —Ç—Ä–µ–π—Å–∞ (OpenTelemetry)                                                  |
| `details`    | –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –æ–±—ä–µ–∫—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è, –æ–±—Ä–µ–∑–∞–Ω–Ω—ã–π –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏) |
| `error`      | –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ (–µ—Å–ª–∏ —É—Ä–æ–≤–µ–Ω—å ‚Äî `error` –∏–ª–∏ `critical`)                                        |

> üí° `traceId` –∏ `spanId` –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è —Å –ø–æ–º–æ—â—å—é **OpenTelemetry**, –Ω–æ –Ω–∞ —Ç–µ–∫—É—â–µ–º —ç—Ç–∞–ø–µ **–Ω–µ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–π—Å—ã** ‚Äî –æ–Ω–∏ –≤–∫–ª—é—á–∞—é—Ç—Å—è –≤ –ª–æ–≥–∏ –¥–ª—è —Å–∫–≤–æ–∑–Ω–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏.  
> –ü–æ—Å–∫–æ–ª—å–∫—É –æ–Ω–∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ `fields`, –∏—Ö –Ω–µ–ª—å–∑—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏ –≤ InfluxDB, –Ω–æ –æ–Ω–∏ –¥–æ—Å—Ç—É–ø–Ω—ã –¥–ª—è –ø–æ–∏—Å–∫–∞ –∏ –æ—Ç–ª–∞–¥–∫–∏ –≤ Grafana.

---

## Fallback-–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (¬´–ª–æ–≥–≥–∏—Ä—É–π, —á–µ–º –º–æ–∂–µ—à—å¬ª)

–î–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏—è:

1. **–û—Å–Ω–æ–≤–Ω–æ–π –∫–∞–Ω–∞–ª**: –æ—Ç–ø—Ä–∞–≤–∫–∞ –≤ InfluxDB.
2. **–†–µ–∑–µ—Ä–≤**: –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ InfluxDB ‚Äî –∑–∞–ø–∏—Å—å –≤ –ª–æ–∫–∞–ª—å–Ω—ã–π —Ñ–∞–π–ª `.log`.
3. **–§–∏–Ω–∞–ª—å–Ω—ã–π fallback**: –µ—Å–ª–∏ —Ñ–∞–π–ª –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω ‚Äî –≤—ã–≤–æ–¥ –≤ `stdout`.

> ‚úÖ –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ **–Ω–∏ –æ–¥–Ω–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–±—ã—Ç–∏–µ –Ω–µ –±—É–¥–µ—Ç –ø–æ—Ç–µ—Ä—è–Ω–æ**, –¥–∞–∂–µ –ø—Ä–∏ –ø–æ–ª–Ω–æ–º –æ—Ç–∫–∞–∑–µ –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π.

---

## –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è (Grafana)

–î–∞—à–±–æ—Ä–¥—ã –¥–æ—Å—Ç—É–ø–Ω—ã –≤ **Grafana** –ø–æ –∞–¥—Ä–µ—Å—É:  
üîó `http://192.168.6.191:3000`

–î–æ—Å—Ç—É–ø–Ω—ã–µ –ø–∞–Ω–µ–ª–∏:

- –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π –ø–æ —É—Ä–æ–≤–Ω—è–º (`info` / `warning` / `error`);
- –•—Ä–æ–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –ø–æ—Ç–æ–∫ –≤—Å–µ—Ö –ª–æ–≥–æ–≤;
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ `serviceName`, `eventType`, `trigger`;
- –ü–æ–∏—Å–∫ –ø–æ `traceId` –∏ `spanId` –≤ –ø–æ–ª–µ `details` –∏–ª–∏ —á–µ—Ä–µ–∑ –ø–æ–ª–Ω–æ—Ç–µ–∫—Å—Ç–æ–≤—ã–π –ø–æ–∏—Å–∫;
- –ê–Ω–∞–ª–∏–∑ –æ—à–∏–±–æ–∫ —Å –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–æ–π –ø–æ `error` –∏ `eventType`.

---

## –ê–ª–µ—Ä—Ç–∏–Ω–≥

- –°–æ–±—ã—Ç–∏—è —É—Ä–æ–≤–Ω—è `error` –∏ `critical` –≤ **production** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç –∞–ª–µ—Ä—Ç—ã.
- –ê–ª–µ—Ä—Ç—ã –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤ **Telegram** —á–µ—Ä–µ–∑ –±–æ—Ç–∞.
- –í —Å–æ–æ–±—â–µ–Ω–∏–∏ —É–∫–∞–∑—ã–≤–∞—é—Ç—Å—è:
  - –£—Ä–æ–≤–µ–Ω—å –∏ —Ç–∏–ø —Å–æ–±—ã—Ç–∏—è;
  - `traceId` / `spanId` (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã);
  - –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –æ—à–∏–±–∫–∏;
  - –°—Å—ã–ª–∫–∞ –Ω–∞ Grafana (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ).

> ‚ö†Ô∏è –ê–ª–µ—Ä—Ç–∏–Ω–≥ **–æ—Ç–∫–ª—é—á—ë–Ω** –≤ `dev` –∏ `stage`.

---

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

- ‚úÖ –í—Å–µ–≥–¥–∞ –ø–µ—Ä–µ–¥–∞–≤–∞–π—Ç–µ `correlationId` –≤ `details` (–µ—Å–ª–∏ –ø—Ä–∏–º–µ–Ω–∏–º–æ) ‚Äî —ç—Ç–æ –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ —Å–∫–≤–æ–∑–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤.
- ‚úÖ –ù–µ –ª–æ–≥–∏—Ä—É–π—Ç–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–ø–∞—Ä–æ–ª–∏, –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ) –≤ `details`.

---

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

| –°–∏—Å—Ç–µ–º–∞       | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                                             |
| ------------- | ------------------------------------------------------ |
| InfluxDB      | –•—Ä–∞–Ω–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ª–æ–≥–æ–≤ –≤ —Ñ–æ—Ä–º–∞—Ç–µ `Log`       |
| Grafana       | –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∏ –ø–æ–∏—Å–∫ –ø–æ –ª–æ–≥–∞–º                          |
| Telegram      | –ê–ª–µ—Ä—Ç–∏–Ω–≥ –ø–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–º —Å–æ–±—ã—Ç–∏—è–º                       |
| OpenTelemetry | –ì–µ–Ω–µ—Ä–∞—Ü–∏—è `traceId` / `spanId` (–≤–∫–ª—é—á–∞—é—Ç—Å—è –≤ `fields`) |

> üí° –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π `LoggerAdapter`, —Ä–µ–∞–ª–∏–∑—É—é—â–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å `Log`.  
> –≠—Ç–æ –∞–±—Å—Ç—Ä–∞–≥–∏—Ä—É–µ—Ç –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É –æ—Ç –¥–µ—Ç–∞–ª–µ–π —Ç–µ–ª–µ–º–µ—Ç—Ä–∏–∏ –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ª–µ–≥–∫–æ –∑–∞–º–µ–Ω–∏—Ç—å –±—ç–∫–µ–Ω–¥ –≤ –±—É–¥—É—â–µ–º.
