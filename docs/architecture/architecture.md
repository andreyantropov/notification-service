# –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç –∫–æ–Ω—Ü–µ–ø—Ç—É–∞–ª—å–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É —Å–µ—Ä–≤–∏—Å–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π ‚Äî –µ–≥–æ —Ü–µ–ª–∏, —Å—Ç—Ä—É–∫—Ç—É—Ä—É, –∫–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã –∏ —Ä–æ–ª–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤.

–û–Ω –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è:

- –Ω–æ–≤—ã—Ö —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤,
- –∞—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä–æ–≤,
- DevOps,
- —Ç–µ—Ö, –∫—Ç–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç —Å–µ—Ä–≤–∏—Å –≤ –¥—Ä—É–≥–∏–µ —Å–∏—Å—Ç–µ–º—ã.

> üí° –î–æ–∫—É–º–µ–Ω—Ç —Ñ–æ–∫—É—Å–∏—Ä—É–µ—Ç—Å—è –Ω–∞ **"–ø–æ—á–µ–º—É" –∏ "–∫–∞–∫ –≤ —Ü–µ–ª–æ–º"**, –∞ –Ω–µ –Ω–∞ –¥–µ—Ç–∞–ª—è—Ö —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏.  
> –ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ ‚Äî –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö —Ñ–∞–π–ª–∞—Ö `docs/`.

> üéØ –≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –±—É–¥–µ—Ç –ø–æ–ª–µ–∑–µ–Ω:
>
> - **–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫—É** ‚Äî —á—Ç–æ–±—ã –ø–æ–Ω—è—Ç—å, –∫–∞–∫ —É—Å—Ç—Ä–æ–µ–Ω —Å–µ—Ä–≤–∏—Å –∏ –≥–¥–µ —á—Ç–æ –ª–µ–∂–∏—Ç.
> - **DevOps / SRE** ‚Äî —á—Ç–æ–±—ã –ø–æ–Ω—è—Ç—å, –∫–∞–∫ —Å–µ—Ä–≤–∏—Å –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç—Å—è.
> - **–ê—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä—É** ‚Äî —á—Ç–æ–±—ã –æ—Ü–µ–Ω–∏—Ç—å –ø—Ä–∏–º–µ–Ω–∏–º–æ—Å—Ç—å –≤ –¥—Ä—É–≥–∏—Ö —Å–∏—Å—Ç–µ–º–∞—Ö.
> - **–¢–µ—Å—Ç–∏—Ä–æ–≤—â–∏–∫—É** ‚Äî —á—Ç–æ–±—ã –ø–æ–Ω—è—Ç—å, –∫–∞–∫–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –ø–æ–∫—Ä—ã—Ç—ã.

## –¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞

–°–µ—Ä–≤–∏—Å –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º —á–µ—Ä–µ–∑ Bitrix24 API –∏–ª–∏ Email.
–¢–µ–ª–µ–º–µ—Ç—Ä–∏—è (–ª–æ–≥–∏, —Ç—Ä–µ–π—Å—ã, –º–µ—Ç—Ä–∏–∫–∏) —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ OpenTelemetry –∏ –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –≤ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π OTel Collector –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞.

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

````src/
‚îú‚îÄ‚îÄ application/ # –ü—Ä–∏–∫–ª–∞–¥–Ω–æ–π —É—Ä–æ–≤–µ–Ω—å: –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ ‚îú‚îÄ‚îÄ ports/ # –ü–æ—Ä—Ç—ã
‚îÇ ‚îú‚îÄ‚îÄ services/ # –°–µ—Ä–≤–∏—Å—ã
‚îÇ ‚îú‚îÄ‚îÄ types/ # –¢–∏–ø—ã
‚îÇ ‚îî‚îÄ‚îÄ useCases/ # UseCase'—ã
‚îú‚îÄ‚îÄ composition/ # Composition Root
‚îÇ ‚îú‚îÄ‚îÄ bootstrap/ # –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ ‚îú‚îÄ‚îÄ container/ # DI-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏
‚îÇ ‚îú‚îÄ‚îÄ lifecycle/ # –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ ‚îú‚îÄ‚îÄ telemetry/ # –¢–µ–ª–µ–º–µ—Ç—Ä–∏—è
‚îÇ ‚îî‚îÄ‚îÄ types/ # –¢–∏–ø—ã
‚îú‚îÄ‚îÄ configs/ # –ö–æ–Ω—Ñ–∏–≥–∏ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã—Ö —Å—É—â–Ω–æ—Å—Ç–µ–π
‚îú‚îÄ‚îÄ domain/ # –î–æ–º–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å
‚îÇ ‚îú‚îÄ‚îÄ ports/ # –ü–æ—Ä—Ç—ã
‚îÇ ‚îî‚îÄ‚îÄ types/ # –¢–∏–ø—ã
‚îú‚îÄ‚îÄ infrastructure/ # –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç—ã
‚îÇ ‚îú‚îÄ‚îÄ channels/ # –ö–∞–Ω–∞–ª—ã —Ä–∞—Å—Å—ã–ª–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
‚îÇ ‚îú‚îÄ‚îÄ counters/ # –°—á–µ—Ç—á–∏–∫–∏
‚îÇ ‚îú‚îÄ‚îÄ generators/ # –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ã
‚îÇ ‚îú‚îÄ‚îÄ http/ # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–æ–≤
‚îÇ ‚îú‚îÄ‚îÄ ports/ # –ü–æ—Ä—Ç—ã
‚îÇ ‚îú‚îÄ‚îÄ queues/ # –û—á–µ—Ä–µ–¥–∏
‚îÇ ‚îú‚îÄ‚îÄ telemetry/ # –¢–µ–ª–µ–º–µ—Ç—Ä–∏—è
‚îÇ ‚îî‚îÄ‚îÄ types/ # –¢–∏–ø—ã
‚îú‚îÄ‚îÄ migrations/ # –°–∫—Ä–∏–ø—Ç—ã –º–∏–≥—Ä–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ shared/ # –û–±—â–∏–µ –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏ –∏ —É—Ç–∏–ª–∏—Ç—ã
‚îú‚îÄ‚îÄ ui/ # –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
‚îÇ ‚îî‚îÄ‚îÄ openapi/ # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Swagger
‚îî‚îÄ‚îÄ index.ts # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã

–ü—Ä–æ–µ–∫—Ç –ø–æ—Å—Ç—Ä–æ–µ–Ω –Ω–∞ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã—Ö –ø–æ–¥—Ö–æ–¥–∞—Ö, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—â–∏—Ö **–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ—Å—Ç—å**, **—Ä–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å** –∏ **–Ω–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã**.

### –û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã

- **Clean Architecture**
  –ß—ë—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ —Å–ª–æ–∏: `domain`, `application`, `infrastructure`, `ui`.
  –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–∞ –æ—Ç –≤–Ω–µ—à–Ω–∏—Ö –¥–µ—Ç–∞–ª–µ–π (HTTP, –±–∞–∑—ã, –æ—á–µ—Ä–µ–¥–∏).

- **12-Factor App**
  –°–µ—Ä–≤–∏—Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø—Ä–∏–Ω—Ü–∏–ø–∞–º [12-factor](https://12factor.net/):
  - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (`.env`).
  - –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è (stateless).
  - –ï–¥–∏–Ω—ã–π –∫–æ–¥–±–µ–π–∑, —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã.
  - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ `stdout`.
    –≠—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç **–ø–µ—Ä–µ–Ω–æ—Å–∏–º–æ—Å—Ç—å** –∏ **–ø–æ–¥–¥–µ—Ä–∂–∫—É CI/CD**.

- **Dependency Injection (DI)**
  –í—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è —è–≤–Ω–æ, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç:
  - –ì–∏–±–∫–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –¥–æ—Å—Ç–∞–≤–∫–∏).
  - –õ–µ–≥–∫–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å (–ø–æ–¥–º–µ–Ω–∞ –º–æ–∫–∞–º–∏).
  - –ò–∑–±–µ–∂–∞—Ç—å –∂—ë—Å—Ç–∫–æ–π —Å–≤—è–∑–∞–Ω–Ω–æ—Å—Ç–∏.

- **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —Å—Ç–∏–ª—å –∏ –ø—Ä–æ—Å—Ç–æ—Ç–∞**
  –°–µ—Ä–≤–∏—Å—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∫–∞–∫ **—á–∏—Å—Ç—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏** —Å —è–≤–Ω—ã–º–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏ –∏ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º.
  –ú—ã —Å–ª–µ–¥—É–µ–º –ø—Ä–∏–Ω—Ü–∏–ø–∞–º **KISS** (Keep It Simple) –∏ **DRY** (Don't Repeat Yourself):
  - –ü–æ–≤—Ç–æ—Ä—è—é—â–∞—è—Å—è –ª–æ–≥–∏–∫–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, fallback-–æ—Ç–ø—Ä–∞–≤–∫–∞) –≤—ã–Ω–µ—Å–µ–Ω–∞ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –º–æ–¥—É–ª–∏.
  - –°–ª–æ–∂–Ω—ã–µ –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —Ä–µ–∞–ª—å–Ω–æ–π –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–µ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è).
    –≠—Ç–æ —É–ø—Ä–æ—â–∞–µ—Ç –ø–æ–Ω–∏–º–∞–Ω–∏–µ, —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫—É –∫–æ–¥–∞.

## –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

1. **–°–µ—Ä–≤–∏—Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (NS)**
   - –û–ø–∏—Å–∞–Ω–∏–µ: –°–µ—Ä–≤–∏—Å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–æ–π —Ä–∞—Å—Å—ã–ª–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º —á–µ—Ä–µ–∑ —Ä–∞–∑–ª–∏—á–Ω—ã–µ –∫–∞–Ω–∞–ª—ã —Å–≤—è–∑–∏ (Bitrix24, Email). –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø—Ä–∏—Ö–æ–¥—è—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä –ø–æ API.
   - –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏: TypeScript + Node.js.
   - –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
     - –ë–∏–±–ª–∏–æ—Ç–µ–∫–∏: `axios`, `nodemailer`, `express`, `winston`, `dotenv`, `awilix`, `@opentelemetry/*`, `@cloudamqp/amqp-client`.
     - –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏: `eslint`, `prettier`, `vitest`, `ts-node`, `nodemon`.
2. **OpenTelemetry Collector (OTel Collector)**
   - –û–ø–∏—Å–∞–Ω–∏–µ: –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–∏–µ–º–Ω–∏–∫ —Ç–µ–ª–µ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö (–ª–æ–≥–æ–≤, —Ç—Ä–µ–π—Å–æ–≤). –ü—Ä–∏–Ω–∏–º–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –æ—Ç —Å–µ—Ä–≤–∏—Å–∞ –∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç –∏—Ö –≤ —Å–∏—Å—Ç–µ–º—ã —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ –∞–Ω–∞–ª–∏–∑–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, Grafana).
   - –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏: OpenTelemetry Collector.
   - –†–æ–ª—å: –ê–≥—Ä–µ–≥–∞—Ü–∏—è, –æ–±–æ–≥–∞—â–µ–Ω–∏–µ –∏ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è —Ç–µ–ª–µ–º–µ—Ç—Ä–∏–∏ –∏–∑ –≤—Å–µ—Ö –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤ –∫–æ–º–ø–∞–Ω–∏–∏.
3. **–ö–∞–Ω–∞–ª—ã –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π**
   - **Bitrix24**: –ö–∞–Ω–∞–ª –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π —á–µ—Ä–µ–∑ API Bitrix24.
     - –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞: `axios`.
   - **SMTP**: –ö–∞–Ω–∞–ª –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π —á–µ—Ä–µ–∑ –ø–æ—á—Ç–æ–≤—ã–π —Å–µ—Ä–≤–µ—Ä.
     - –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ `nodemailer`.
4. **–û—á–µ—Ä–µ–¥—å —Å–æ–æ–±—â–µ–Ω–∏–π (RabbitMQ)**
   - –û–ø–∏—Å–∞–Ω–∏–µ: –ë—Ä–æ–∫–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–µ—Å—Ä–æ—á–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π. –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –Ω–∞–¥—ë–∂–Ω—É—é –¥–æ—Å—Ç–∞–≤–∫—É, retry-–ª–æ–≥–∏–∫—É –∏ dead-letter-–æ—á–µ—Ä–µ–¥—å (DQL) –¥–ª—è –æ—Ç–ª–æ–∂–µ–Ω–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫.
   - –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏: RabbitMQ (AMQP 0.9.1).
   - –ö–ª–∏–µ–Ω—Ç—Å–∫–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞: `@cloudamqp/amqp-client`.

## –î–∏–∞–≥—Ä–∞–º–º–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

### 1. –í–Ω–µ—à–Ω—è—è —Å—Ö–µ–º–∞

```mermaid
flowchart LR
    ExternalSystem[–í–Ω–µ—à–Ω—è—è —Å–∏—Å—Ç–µ–º–∞] -->|HTTP POST /notifications| NS[notification-service]
    NS -->|–æ—Ç–ø—Ä–∞–≤–∫–∞| Bitrix24[(Bitrix24 API)]
    NS -->|–æ—Ç–ø—Ä–∞–≤–∫–∞| SMTP[(SMTP —Å–µ—Ä–≤–µ—Ä)]
    NS -->|–ø—É–±–ª–∏–∫–∞—Ü–∏—è| RabbitMQ[(RabbitMQ)]
    RabbitMQ -->|–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ| NS
    NS -->|—ç–∫—Å–ø–æ—Ä—Ç —Ç–µ–ª–µ–º–µ—Ç—Ä–∏–∏| OtelCollector[(OTel Collector)]
    OtelCollector --> Grafana[Grafana]
    Bitrix24 --> User[–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å]
    SMTP --> User
````

### 2. –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è —Å—Ö–µ–º–∞

```mermaid
flowchart TB
    subgraph UI
        HTTP[Express.js API]
    end

    subgraph Application
        UseCase[SendNotificationUseCase]
        DeliveryService[NotificationDeliveryService]
        Strategy[DeliveryStrategy]
    end

    subgraph Infrastructure
        Bitrix[BitrixChannel]
        Email[SmtpChannel]
        Producer[RabbitMQProducer]
        Consumer[RabbitMQConsumer]
        Logger[InfluxLogger]
    end

    HTTP --> UseCase
    UseCase --> DeliveryService
    DeliveryService --> Strategy
    Strategy --> Bitrix
    Strategy --> Email
    UseCase --> Producer
    Consumer --> DeliveryService
    UseCase --> Logger
    DeliveryService --> Logger
```

## –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞ —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã

1. **–ü–æ–ª—É—á–µ–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π**:
   - –°–µ—Ä–≤–∏—Å –ø–æ–ª—É—á–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ `POST /notifications`.
2. **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Å—Ä–æ—á–Ω–æ—Å—Ç–∏**:
   - **–°—Ä–æ—á–Ω—ã–µ** (`isImmediate: true`) ‚Äî –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è **–Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ** —á–µ—Ä–µ–∑ `NotificationDeliveryService`.
   - **–ù–µ—Å—Ä–æ—á–Ω—ã–µ** (`isImmediate: false` –∏–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç) ‚Äî **–ø—É–±–ª–∏–ª–∏–∫—É—é—Ç—Å—è –≤ RabbitMQ**.
3. **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞**:
   - `RabbitMQConsumer` –ø–æ—Ç—Ä–µ–±–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∏—Ö —á–µ—Ä–µ–∑ `NotificationDeliveryService`.
   - –û—à–∏–±–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ retry –∏ DLQ.
4. **–û—Ç–≤–µ—Ç –∫–ª–∏–µ–Ω—Ç—É**:
   - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è `202 Accepted` (–≤–∞–ª–∏–¥–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø—Ä–∏–Ω—è—Ç—ã –≤ –æ–±—Ä–∞–±–æ—Ç–∫—É).
   - –§–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞ ‚Äî –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞.
5. **–¢–µ–ª–µ–º–µ—Ç—Ä–∏—è**:
   - –í—Å–µ —ç—Ç–∞–ø—ã (–ø—Ä–∏—ë–º, –ø—É–±–ª–∏–∫–∞—Ü–∏—è, –¥–æ—Å—Ç–∞–≤–∫–∞, –æ—à–∏–±–∫–∏) –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ `winston`.
   - –õ–æ–≥–∏, —Ç—Ä–µ–π—Å—ã –∏ –º–µ—Ç—Ä–∏–∫–∏ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –≤ **OTel Collector** —á–µ—Ä–µ–∑ HTTP/OTLP.
   - –î–∞–Ω–Ω—ã–µ –∞–≥—Ä–µ–≥–∏—Ä—É—é—Ç—Å—è –∏ –¥–æ—Å—Ç—É–ø–Ω—ã –≤ —Å–∏—Å—Ç–µ–º–∞—Ö –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ (Grafana).

## –ú–æ–¥—É–ª—å–Ω–∞—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏

–°–∏—Å—Ç–µ–º–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∞ —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —á—Ç–æ–±—ã –±—ã—Ç—å –≥–∏–±–∫–æ–π –∏ –ª–µ–≥–∫–æ —Ç–µ—Å—Ç–∏—Ä—É–µ–º–æ–π. –î–ª—è —ç—Ç–æ–≥–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∏–Ω—Ü–∏–ø –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (`Dependency Injection`) –∏ –ø–∞—Ç—Ç–µ—Ä–Ω **—Ñ–∞–±—Ä–∏–∫**.

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏ —á–µ—Ä–µ–∑ DI-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä

–î–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –≤–Ω–µ—à–Ω–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ñ–∞–±—Ä–∏—á–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:

–≠—Ç–æ –¥–∞—ë—Ç —Å–ª–µ–¥—É—é—â–∏–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:

- **–ö–ª–∏–µ–Ω—Ç—ã –ª–µ–≥–∫–æ –∑–∞–º–µ–Ω–∏—Ç—å**
- **–ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö**
- **–£–¥–æ–±—Å—Ç–≤–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è** ‚Äî –º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –º–æ–∫–Ω—É—Ç—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

–ü—Ä–∏–º–µ—Ä:

```ts
container.register({
  bitrixChannel: asFunction(({ bitrixConfig }) =>
    createBitrixChannel(bitrixConfig),
  ).singleton(),
  smtpChannel: asFunction(({ smtpConfig }) =>
    createSmtpChannel(smtpConfig),
  ).singleton(),
  notificationDeliveryService: asFunction(
    ({ bitrixChannel, smtpChannel, logger }) =>
      createNotificationDeliveryService([bitrixChannel, smtpChannel], logger),
  ).singleton(),
});
```

## API —Å–µ—Ä–≤–∏—Å–∞

API —Å–µ—Ä–≤–∏—Å–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø—Ä–æ—Å—Ç–æ–π HTTP-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π —Ä–∞–∑–ª–∏—á–Ω—ã–º –ø–æ–ª—É—á–∞—Ç–µ–ª—è–º (email, Bitrix24 –∏ –¥—Ä.). –û—Å–Ω–æ–≤–Ω–æ–π —ç–Ω–¥–ø–æ–∏–Ω—Ç `/v1/notifications` –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∫–∞–∫ –æ–¥–∏–Ω–æ—á–Ω—ã–µ, —Ç–∞–∫ –∏ –ø–∞–∫–µ—Ç–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (–¥–æ 100 –∑–∞ —Ä–∞–∑), –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è –≥–∏–±–∫–æ—Å—Ç—å –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø—Ä–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏.

–°–µ—Ä–≤–∏—Å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –Ω–∞ **Express.js** –±–ª–∞–≥–æ–¥–∞—Ä—è –µ–≥–æ –ª—ë–≥–∫–æ—Å—Ç–∏ –∏ –±—ã—Å—Ç—Ä–æ—Ç–µ, —á—Ç–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º –∫ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–º—É –æ–≤–µ—Ä—Ö–µ–¥—É –∏ –≤—ã—Å–æ–∫–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ API —Å—Ç—Ä–æ–∏—Ç—Å—è –≤–æ–∫—Ä—É–≥ –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤ REST –∏ HTTP-—Å–µ–º–∞–Ω—Ç–∏–∫–∏: –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Å—Ç–∞—Ç—É—Å-–∫–æ–¥—ã, middleware-–æ–±—Ä–∞–±–æ—Ç–∫–∞ (–≤–∞–ª–∏–¥–∞—Ü–∏—è, rate limiting, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ) –∏ healthcheck-—ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–ª—è –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–∏.

–í—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –∑–∞—â–∏—â–µ–Ω—ã JWT-–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π: –∫–ª–∏–µ–Ω—Ç—ã –æ–±—è–∑–∞–Ω—ã –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –≤–∞–ª–∏–¥–Ω—ã–π —Ç–æ–∫–µ–Ω **Keycloak** –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ `Authorization`.

–î–ª—è —É–¥–æ–±—Å—Ç–≤–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∞ **–ø–æ–ª–Ω–∞—è OpenAPI-—Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è (Swagger)**, –¥–æ—Å—Ç—É–ø–Ω–∞—è –≤ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–π —Ñ–æ—Ä–º–µ –ø–æ –∞–¥—Ä–µ—Å—É `/api-docs`. –û–Ω–∞ –≤–∫–ª—é—á–∞–µ—Ç:

- —Ç–æ—á–Ω—ã–µ —Å—Ö–µ–º—ã –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –æ—Ç–≤–µ—Ç–æ–≤,
- –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è,
- –æ–ø–∏—Å–∞–Ω–∏—è –≤—Å–µ—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤ –∏ —Å—Ç–∞—Ç—É—Å–æ–≤.

> üí° –ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API, –≤–∫–ª—é—á–∞—è —Ñ–æ—Ä–º–∞—Ç—ã –∑–∞–ø—Ä–æ—Å–æ–≤, –∫–æ–¥—ã –æ—Ç–≤–µ—Ç–æ–≤ –∏ –ø—Ä–∏–º–µ—Ä—ã, –≤—ã–Ω–µ—Å–µ–Ω–∞ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ñ–∞–π–ª: [`api.md`](./api.md).

## –û—á–µ—Ä–µ–¥—å —Å–æ–æ–±—â–µ–Ω–∏–π (RabbitMQ)

–°–µ—Ä–≤–∏—Å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **RabbitMQ** –∫–∞–∫ –Ω–∞–¥—ë–∂–Ω—ã–π –±—Ä–æ–∫–µ—Ä –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ **–Ω–µ—Å—Ä–æ—á–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π** (`isImmediate: false`).

### –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:

1. –ü—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –Ω–µ—Å—Ä–æ—á–Ω–æ–≥–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Å–µ—Ä–≤–∏—Å **–ø—É–±–ª–∏–∫—É–µ—Ç –µ–≥–æ –≤ –æ—á–µ—Ä–µ–¥—å** —á–µ—Ä–µ–∑ `RabbitMQProducer`.
2. –û—Ç–¥–µ–ª—å–Ω—ã–π `RabbitMQConsumer` **–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –ø–æ—Ç—Ä–µ–±–ª—è–µ—Ç** —Å–æ–æ–±—â–µ–Ω–∏—è –∏–∑ –æ—á–µ—Ä–µ–¥–∏.
3. –ö–∞–∂–¥–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è —Å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º **–Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω–æ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –¥–æ—Å—Ç–∞–≤–∫–∏**.
4. –ü—Ä–∏ –æ—à–∏–±–∫–µ –æ—Ç–ø—Ä–∞–≤–∫–∏:
   - –°–æ–æ–±—â–µ–Ω–∏–µ **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è** (retry) –¥–æ N —Ä–∞–∑.
   - –ü–æ—Å–ª–µ –∏—Å—á–µ—Ä–ø–∞–Ω–∏—è –ø–æ–ø—ã—Ç–æ–∫ –æ–Ω–æ –ø–µ—Ä–µ–º–µ—â–∞–µ—Ç—Å—è –≤ **Dead Letter Queue (DLQ)** –¥–ª—è —Ä—É—á–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∏–ª–∏ –æ—Ç–ª–æ–∂–µ–Ω–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏.

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:

- **–û—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å**: –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞ –Ω–µ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –ø–æ—Ç–µ—Ä–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π.
- **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å**: –º–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤ consumer'–æ–≤.
- **–ì–∏–±–∫–æ—Å—Ç—å**: retry –∏ DLQ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è –Ω–∞ —É—Ä–æ–≤–Ω–µ RabbitMQ.

> üí° –ü–æ–¥—Ä–æ–±–Ω–∞—è —Å—Ö–µ–º–∞ —Ç–æ–ø–æ–ª–æ–≥–∏–∏ –æ—á–µ—Ä–µ–¥–µ–π, —Ñ–æ—Ä–º–∞—Ç —Å–æ–æ–±—â–µ–Ω–∏–π –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ DLQ ‚Äî –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –¥–æ–∫—É–º–µ–Ω—Ç–µ: [`docs/rabbitmq.md`](./rabbitmq.md).

## –°—Ç—Ä–∞—Ç–µ–≥–∏—è –¥–æ—Å—Ç–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

–°–µ—Ä–≤–∏—Å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç **–≥–∏–±–∫–∏–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –¥–æ—Å—Ç–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π**, –ø–æ–∑–≤–æ–ª—è—è —É–∫–∞–∑—ã–≤–∞—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ **–¥–ª—è –∫–∞–∂–¥–æ–≥–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ—Ç–¥–µ–ª—å–Ω–æ** —á–µ—Ä–µ–∑ –ø–æ–ª–µ `strategy`.

–î–æ—Å—Ç—É–ø–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏:

- **`send_to_first_available`** (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) ‚Äî –æ—Ç–ø—Ä–∞–≤–∫–∞ —á–µ—Ä–µ–∑ –ø–µ—Ä–≤—ã–π —Ä–∞–±–æ—á–∏–π –∫–∞–Ω–∞–ª:
  - –ü–æ–ø—ã—Ç–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ –ø–µ—Ä–≤—ã–π –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π –∏ —Ä–∞–±–æ—á–∏–π –∫–∞–Ω–∞–ª.
  - –ï—Å–ª–∏ –∫–∞–Ω–∞–ª –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω ‚Äî –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É.
  - –û—Ç–ø—Ä–∞–≤–∫–∞ —Å—á–∏—Ç–∞–µ—Ç—Å—è —É—Å–ø–µ—à–Ω–æ–π –ø—Ä–∏ —É–¥–∞—á–Ω–æ–π –¥–æ—Å—Ç–∞–≤–∫–µ —Ö–æ—Ç—è –±—ã –æ–¥–Ω–∏–º —Å–ø–æ—Å–æ–±–æ–º.

- **`send_to_all_available`** ‚Äî –æ—Ç–ø—Ä–∞–≤–∫–∞ —á–µ—Ä–µ–∑ –≤—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –∫–∞–Ω–∞–ª—ã:
  - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è **–∫–∞–∂–¥–æ–º—É –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ–º—É –∏ —Ä–∞–±–æ—á–µ–º—É –∫–∞–Ω–∞–ª—É**.
  - –û—Ç–ø—Ä–∞–≤–∫–∞ —Å—á–∏—Ç–∞–µ—Ç—Å—è —É—Å–ø–µ—à–Ω–æ–π, –µ—Å–ª–∏ **—Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –∫–∞–Ω–∞–ª** –≤—ã–ø–æ–ª–Ω–∏–ª –¥–æ—Å—Ç–∞–≤–∫—É (–æ—Å—Ç–∞–ª—å–Ω—ã–µ –æ—à–∏–±–∫–∏ —Ñ–∏–∫—Å–∏—Ä—É—é—Ç—Å—è –∫–∞–∫ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è).

–í –æ–±–æ–∏—Ö —Å–ª—É—á–∞—è—Ö –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫ –Ω–∞ –∫–∞–Ω–∞–ª ‚Äî 1 (–º–æ–∂–µ—Ç –±—ã—Ç—å —É–≤–µ–ª–∏—á–µ–Ω–æ —Å –ø–æ–º–æ—â—å—é —É—Ç–∏–ª–∏—Ç—ã `retry`).

> –ù–æ–≤—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∫–æ–¥–∞ —Å–µ—Ä–≤–∏—Å–∞ ‚Äî –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –∏ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –µ—ë –≤ —Ä–µ–µ—Å—Ç—Ä–µ.

> üí° –ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–º —Å—Ç—Ä–∞—Ç–µ–≥–∏—è–º –¥–æ—Å—Ç—É–ø–Ω–∞ –≤: [`docs/strategies.md`](./strategies.md).

## –ë—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏—è –∏ –±–∞—Ç—á–∏–Ω–≥

–î–ª—è –Ω–µ—Å—Ä–æ—á–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (`isImmediate: false` –∏–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç) –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **InMemoryBuffer** ‚Äî –≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –≤ –ø–∞–º—è—Ç–∏.

- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ–º–µ—â–∞—é—Ç—Å—è –≤ –±—É—Ñ–µ—Ä –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏.
- –†–∞–∑ –≤ `PROCESS_BATCHING_INTERVAL` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 60 —Å–µ–∫) —Ñ–æ–Ω–æ–≤—ã–π –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–±–∏—Ä–∞–µ—Ç –≤—Å–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∏—Ö –ø–∞—á–∫–æ–π.
- –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–Ω–∏–∑–∏—Ç—å –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ –≤–Ω–µ—à–Ω–∏–µ API (Bitrix, SMTP) –∏ –∏–∑–±–µ–∂–∞—Ç—å "—Ñ–ª—É–¥–∞".

> ‚ö†Ô∏è –ü—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ —Å–µ—Ä–≤–∏—Å–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ –±—É—Ñ–µ—Ä–µ **—Ç–µ—Ä—è—é—Ç—Å—è**.  
> –î–ª—è –ø–æ–ª–Ω–æ–π –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏ –≤ –±—É–¥—É—â–µ–º –º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ (Redis, Kafka).

## –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è

–°–µ—Ä–≤–∏—Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω –∫–∞–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –≤ —Å—Ä–µ–¥–µ Docker. –≠—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç:

- **–ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–∏–µ** –º–µ–∂–¥—É development, staging –∏ production-—Å—Ä–µ–¥–∞–º–∏.
- **–ò–∑–æ–ª—è—Ü–∏—é –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π** –∏ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ—Å—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏—è.
- **–ü–æ–¥–¥–µ—Ä–∂–∫—É –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è** —á–µ—Ä–µ–∑ CI/CD –∏ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, Kubernetes).

–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ Node.js –∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É–µ—Ç —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏ (Bitrix24, SMTP, InfluxDB) —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è. –í—Å–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ, —á—Ç–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç [12-factor app methodology](https://12factor.net/). –®–∞–±–ª–æ–Ω –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏: env.example.

> üí° –ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ —Å–±–æ—Ä–∫–µ, –∑–∞–ø—É—Å–∫—É –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—é –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–º –¥–æ—Å—Ç—É–ø–Ω–∞ –≤: [`docs/docker.md`](./docker.md).

## –¢–µ–ª–µ–º–µ—Ç—Ä–∏—è

–°–µ—Ä–≤–∏—Å –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø–æ–ª–Ω—É—é –Ω–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç—å —á–µ—Ä–µ–∑ **—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**, **—Å–∫–≤–æ–∑–Ω—É—é –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—é**, **–º–µ—Ç—Ä–∏–∫–∏** –∏ **—Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π —Å–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö** —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞ OpenTelemetry.

–ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã:

- **–°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ OpenTelemetry –∫–∞–∫ –µ–¥–∏–Ω–æ–≥–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞ –¥–ª—è —Å–±–æ—Ä–∞ –º–µ—Ç—Ä–∏–∫, –ª–æ–≥–æ–≤ –∏ —Ç—Ä–µ–π—Å–æ–≤.
- **–ù–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –±—ç–∫–µ–Ω–¥–∞**: –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –∑–Ω–∞–µ—Ç, –∫—É–¥–∞ –ø–æ–ø–∞–¥–∞—é—Ç –¥–∞–Ω–Ω—ã–µ ‚Äî —ç—Ç–æ —Ä–µ—à–∞–µ—Ç OTel Collector.
- **–ß–∏—Å—Ç–æ—Ç–∞ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏**: –°–±–æ—Ä —Ç–µ–ª–µ–º–µ—Ç—Ä–∏–∏ –≤—ã–Ω–µ—Å–µ–Ω –∑–∞ –ø—Ä–µ–¥–µ–ª—ã –¥–æ–º–µ–Ω–∞ —Å –ø–æ–º–æ—â—å—é –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä–æ–≤ (`createMeteredChannel`, `createMeteredNotificationDeliveryService`).
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞—Ü–∏—è**: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (Express, HTTP-–∫–ª–∏–µ–Ω—Ç—ã) –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–æ—Ä–∞—á–∏–≤–∞—é—Ç—Å—è OpenTelemetry SDK.
- **–ï–¥–∏–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –ª–æ–≥–æ–≤**: –í—Å–µ –ª–æ–≥–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω—ã, —Å–æ–¥–µ—Ä–∂–∞—Ç `traceId`, `spanId`, `service.name`, `level`, `timestamp` –∏ –¥—Ä—É–≥–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –ø–æ–ª—è.

### –ß—Ç–æ –≤–∫–ª—é—á–∞–µ—Ç —Ç–µ–ª–µ–º–µ—Ç—Ä–∏—è:

- **–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ JSON-–ª–æ–≥–∏** —á–µ—Ä–µ–∑ `winston`, –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å OpenTelemetry SDK.
- **–°–∫–≤–æ–∑–Ω–∞—è —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞ (traces)**: –∫–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å –∏–º–µ–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π `traceId`, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –ø—É—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ –≤—Å–µ–π —Å–∏—Å—Ç–µ–º–µ.
- **–ú–µ—Ç—Ä–∏–∫–∏**:
  - **–ù–∞ —É—Ä–æ–≤–Ω–µ —Å–µ—Ä–≤–∏—Å–∞**:
    - `notifications_total` ‚Äî –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π.
    - `notifications_processed_by_result_total` ‚Äî —É—Å–ø–µ—Ö/–æ—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏.
    - `notifications_processed_by_subject_total` ‚Äî –ø–æ —Å—É–±—ä–µ–∫—Ç–∞–º.
    - `notifications_processed_by_strategy_total` ‚Äî –ø–æ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è–º –¥–æ—Å—Ç–∞–≤–∫–∏.
    - `notifications_processed_by_priority_total` ‚Äî –ø–æ –ø—Ä–∏–∑–Ω–∞–∫—É —Å—Ä–æ—á–Ω–æ—Å—Ç–∏ (`isImmediate`).
  - **–ù–∞ —É—Ä–æ–≤–Ω–µ –∫–∞–Ω–∞–ª–æ–≤**:
    - `notifications_by_channel_total` ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–ø—Ä–∞–≤–æ–∫ –ø–æ –∫–∞–Ω–∞–ª—É –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É.
    - `channel_latency_ms` ‚Äî –ª–∞—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–∏ `send()`.
- **–≠–∫—Å–ø–æ—Ä—Ç —á–µ—Ä–µ–∑ OTLP**: –º–µ—Ç—Ä–∏–∫–∏, –ª–æ–≥–∏ –∏ —Ç—Ä–µ–π—Å—ã –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤ **OTel Collector** –ø–æ –ø—Ä–æ—Ç–æ–∫–æ–ª—É OTLP/HTTP.
- **–ê–≥—Ä–µ–≥–∞—Ü–∏—è –∏ —Ä–æ—É—Ç–∏–Ω–≥ –≤ OTel Collector**: Collector –æ–±–æ–≥–∞—â–∞–µ—Ç, —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç –∏ –Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —Å–∏—Å—Ç–µ–º—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, Grafana, Prometheus, Loki).

> üí° –ü–æ–¥—Ä–æ–±–Ω–∞—è —Å—Ö–µ–º–∞ –ø–æ–ª–µ–π, —Ñ–æ—Ä–º–∞—Ç–∞ –ª–æ–≥–∞, –æ–ø–∏—Å–∞–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –∏ –¥–∞—à–±–æ—Ä–¥–æ–≤ ‚Äî –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –¥–æ–∫—É–º–µ–Ω—Ç–µ: [`docs/telemetry.md`](./telemetry.md).

## –û—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å

–°–µ—Ä–≤–∏—Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π —É—Å—Ç–æ–π—á–∏–≤ –∫ —á–∞—Å—Ç–∏—á–Ω—ã–º —Å–±–æ—è–º –≤–Ω–µ—à–Ω–∏—Ö —Å–∏—Å—Ç–µ–º –±–ª–∞–≥–æ–¥–∞—Ä—è:

- **–ì–∏–±–∫–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–µ –æ—à–∏–±–æ–∫** ‚Äî —Å–±–æ–π –æ–¥–Ω–æ–≥–æ –∫–∞–Ω–∞–ª–∞ –Ω–µ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É.
- **–°–∫–≤–æ–∑–Ω–æ–π —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–µ** —Å `traceId` –∏ `correlationId` –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏.
- **–ê–ª–µ—Ä—Ç–∏–Ω–≥—É** –Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏.

–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –±—É–¥–µ—Ç –¥–æ—Å—Ç–∞–≤–ª–µ–Ω–æ, –µ—Å–ª–∏ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –∫–∞–Ω–∞–ª –¥–æ—Å—Ç—É–ø–µ–Ω, –∞ –ª–æ–≥–∏ ‚Äî –∑–∞–ø–∏—Å–∞–Ω—ã, –¥–∞–∂–µ –µ—Å–ª–∏ –æ—Å–Ω–æ–≤–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞.

> üí° –ü–æ–¥—Ä–æ–±–Ω–µ–µ ‚Äî –≤: [`docs/resilience.md`](./resilience.md).

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

–°–µ—Ä–≤–∏—Å –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∑–∞—â–∏—Ç—É —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π –∑–∞ —Å—á—ë—Ç:

- **–ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–µ–∫—Ä–µ—Ç–æ–≤** —á–µ—Ä–µ–∑ `.env` (–Ω–µ –≤ –∫–æ–¥–µ).
- **–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞** —á–µ—Ä–µ–∑ HTTPS (–≤–Ω–µ—à–Ω–∏–µ –≤—ã–∑–æ–≤—ã) –∏ TLS-—Ç–µ—Ä–º–∏–Ω–∞—Ü–∏—é –Ω–∞ —É—Ä–æ–≤–Ω–µ nginx.
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏** —Å SMTP-—Å–µ—Ä–≤–µ—Ä–æ–º.
- **JWT-–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤—Ö–æ–¥—è—â–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤** —á–µ—Ä–µ–∑ –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã–π Keycloak-—Ä–µ–∞–ª–º.

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –≤—Ö–æ–¥—è—â–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

–í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –∫ API –∑–∞—â–∏—â–µ–Ω—ã —Å –ø–æ–º–æ—â—å—é JWT-—Ç–æ–∫–µ–Ω–æ–≤, –≤—ã–¥–∞–≤–∞–µ–º—ã—Ö Keycloak:

- –¢–æ–∫–µ–Ω –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ `Authorization: Bearer <token>`.
- –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è middleware –Ω–∞ –æ—Å–Ω–æ–≤–µ JWKS-—ç–Ω–¥–ø–æ–∏–Ω—Ç–∞ Keycloak.
- –ù–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∏–ª–∏ –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã –æ—Ç–∫–ª–æ–Ω—è—é—Ç—Å—è —Å –∫–æ–¥–æ–º `401 Unauthorized`.
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö —Ä–æ–ª–µ–π –∏–ª–∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–µ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏ –ø—Ä–∏–≤–æ–¥—è—Ç –∫ –æ—Ç–≤–µ—Ç—É `403 Forbidden`.

–≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–µ—Ä–≤–∏—Å –∏–∑ –Ω–µ–Ω–∞–¥—ë–∂–Ω—ã—Ö —Å–µ—Ç–µ–π –±–µ–∑ —Å–Ω–∏–∂–µ–Ω–∏—è —É—Ä–æ–≤–Ω—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.

–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∞ —Å —É—á—ë—Ç–æ–º –±—É–¥—É—â–µ–≥–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è: –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –º–æ–∂–Ω–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å Vault, API-–∫–ª—é—á–∏ –∏–ª–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.

> üí° –ü–æ–¥—Ä–æ–±–Ω–µ–µ ‚Äî –≤: [`docs/security.md`](./security.md).

## –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å –∏ —Ä–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å

–°–µ—Ä–≤–∏—Å –≤ —Ü–µ–ª–æ–º **stateless**, –∑–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ–º **InMemoryBuffer**, –∫–æ—Ç–æ—Ä—ã–π —Ö—Ä–∞–Ω–∏—Ç –Ω–µ—Å—Ä–æ—á–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –¥–æ –æ—Ç–ø—Ä–∞–≤–∫–∏.

–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç:

- **–ì–∏–±–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –∫–∞–Ω–∞–ª–æ–≤** (Telegram, SMS –∏ –¥—Ä.) —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å `Channel`.
- **–ü–æ–¥–º–µ–Ω—è–µ–º—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –¥–æ—Å—Ç–∞–≤–∫–∏** (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–ø–µ—Ä–≤—ã–π –¥–æ—Å—Ç—É–ø–Ω—ã–π", "–≤—Å–µ –∫–∞–Ω–∞–ª—ã").
- **–ú–æ–¥—É–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π fallback-—Ü–µ–ø–æ—á–µ–∫.
- **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø—Ä–∞–∫—Ç–∏–∫ observability** —á–µ—Ä–µ–∑ OpenTelemetry, —á—Ç–æ —É–ø—Ä–æ—â–∞–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å –ª—é–±—ã–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –∫–æ–¥–µ.
- **–ú–µ—Ç—Ä–∏–∫–∏ –ª–µ–≥–∫–æ —Ä–∞—Å—à–∏—Ä—è—é—Ç—Å—è** ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∫–∞–Ω–∞–ª–∞ –∏–ª–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –ø–æ—è–≤–ª–µ–Ω–∏—é –Ω–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –º–µ—Ç—Ä–∏–∫–∞—Ö –±–ª–∞–≥–æ–¥–∞—Ä—è low-cardinality –∞—Ç—Ä–∏–±—É—Ç–∞–º.

–≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–µ—Ä–≤–∏—Å –ø–æ–¥ —Ä–∞—Å—Ç—É—â–∏–µ –Ω–∞–≥—Ä—É–∑–∫–∏ –∏ –Ω–æ–≤—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è, –Ω–µ –Ω–∞—Ä—É—à–∞—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –ª–æ–≥–∏–∫–∏.

> üí° –ü–æ–¥—Ä–æ–±–Ω–µ–µ ‚Äî –≤: [`docs/scalability.md`](./scalability.md).

## Use Cases: –†–µ—Ç—Ä–∞–Ω—Å–ª—è—Ü–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

–°–µ—Ä–≤–∏—Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π **–Ω–µ –∏–Ω–∏—Ü–∏–∏—Ä—É–µ—Ç** –æ—Ç–ø—Ä–∞–≤–∫—É –∏ **–Ω–µ –∑–Ω–∞–µ—Ç –æ –±–∏–∑–Ω–µ—Å-—Å–æ–±—ã—Ç–∏—è—Ö**. –û–Ω —è–≤–ª—è–µ—Ç—Å—è **–ø–∞—Å—Å–∏–≤–Ω—ã–º —Ä–µ—Ç—Ä–∞–Ω—Å–ª—è—Ç–æ—Ä–æ–º (dumb pipe)**, –∫–æ—Ç–æ—Ä—ã–π:

- –ü—Ä–∏–Ω–∏–º–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ—Ç ERP –∏ –¥—Ä—É–≥–∏—Ö —Å–∏—Å—Ç–µ–º.
- –î–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∏—Ö –ø–æ–ª—É—á–∞—Ç–µ–ª—è–º —á–µ—Ä–µ–∑ Bitrix24, email –∏ –¥—Ä—É–≥–∏–µ –∫–∞–Ω–∞–ª—ã.
- –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –¥–æ—Å—Ç–∞–≤–∫—É –ø–æ –ø–µ—Ä–≤–æ–º—É —Ä–∞–±–æ—á–µ–º—É –∫–∞–Ω–∞–ª—É.
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç–∞—Ç—É—Å –ø—Ä–∏—ë–º–∞ –≤ –æ–±—Ä–∞–±–æ—Ç–∫—É.

–°–µ–π—á–∞—Å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –¥–≤–∞ —Å—Ü–µ–Ω–∞—Ä–∏—è:

1. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∫–æ–º–º–µ—Ä—Å–∞–Ω—Ç–æ–≤ –ø—Ä–∏ –ø—Ä–∏—Å–≤–æ–µ–Ω–∏–∏ —Å–µ—Ä–∏–π–Ω–æ–≥–æ –Ω–æ–º–µ—Ä–∞.
2. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏.

–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ "–≥–ª—É–ø–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞" –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø—Ä–æ—Å—Ç–æ—Ç—É, –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç—å –∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π.

> üí° –ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ ‚Äî –≤: [`docs/use-cases.md`](./use-cases.md).

## Composition Root: —Å–±–æ—Ä–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

–í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–∫–∞–Ω–∞–ª—ã –æ—Ç–ø—Ä–∞–≤–∫–∏, –ª–æ–≥–≥–µ—Ä—ã, use cases) —Å–æ–±–∏—Ä–∞—é—Ç—Å—è –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ ‚Äî **Composition Root**.

–ó–¥–µ—Å—å:

- –†–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∏–Ω–∂–µ–∫—Ç–∏—Ä—É—é—Ç—Å—è –≤ use cases.
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è fallback-–ª–æ–≥–∏–∫–∞ –∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –¥–æ—Å—Ç–∞–≤–∫–∏.
- –§–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –≥–æ—Ç–æ–≤—ã–π HTTP-—Å–µ—Ä–≤–µ—Ä.

–°–±–æ—Ä–∫–∞ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Å –ø–æ–º–æ—â—å—é **[Awilix](https://github.com/jeffijoe/awilix)** ‚Äî DI-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞, –∫–æ—Ç–æ—Ä—ã–π —É–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏ –∏ –∏—Ö –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º.

–≠—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç:

- –ß—ë—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏.
- –ì–∏–±–∫–æ—Å—Ç—å –∏ —Ç–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å.
- –ï–¥–∏–Ω–æ–µ –º–µ—Å—Ç–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏.

> üí° –ü–æ–¥—Ä–æ–±–Ω–µ–µ ‚Äî –≤: [`docs/composition-root.md`](./composition-root.md).
