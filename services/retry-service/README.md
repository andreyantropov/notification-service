# üîÑ Retry Service

–°–µ—Ä–≤–∏—Å –¥–ª—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏–π —Å –ø–æ–≤—Ç–æ—Ä–Ω—ã–º–∏ –ø–æ–ø—ã—Ç–∫–∞–º–∏ –∏ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è –≤ **Dead Letter Queue (DLQ)**.  
–û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –Ω–∞–¥—ë–∂–Ω—É—é –¥–æ—Å—Ç–∞–≤–∫—É —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –∑–∞ —Å—á—ë—Ç –≥–∏–±–∫–æ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –ø–æ–≤—Ç–æ—Ä–æ–≤ –∏ –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏.

> ‚öôÔ∏è –ú–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–µ–Ω, –±–µ—Å—à–æ–≤–Ω–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç—Å—è –≤ –ø–ª–∞—Ç—Ñ–æ—Ä–º—É —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –∏ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –≤–Ω–µ—à–Ω–µ–≥–æ API.

---

## ‚öôÔ∏è –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç          | –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ                |
| ------------------ | ------------------------- |
| **Node.js**        | v23.x –∏–ª–∏ –≤—ã—à–µ            |
| **npm**            | v10.x –∏–ª–∏ –≤—ã—à–µ            |
| **RabbitMQ**       | v3.10+, –¥–æ—Å—Ç—É–ø–Ω—ã–π –ø–æ AMQP |

---

## üìÑ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–í—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–¥–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è.  
–ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é ‚Äî –≤ —Ñ–∞–π–ª–µ:  
üëâ [.env.example](./.env.example)

```bash
cp .env.example .env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env –ø–æ–¥ –≤–∞—à–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
```

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```bash
npm install
npm run start
```

> –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ RabbitMQ –∑–∞–ø—É—â–µ–Ω –∏ –¥–æ—Å—Ç—É–ø–µ–Ω –¥–æ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–∏—Å–∞.

---

## ‚ñ∂Ô∏è –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

| –ö–æ–º–∞–Ω–¥–∞                 | –û–ø–∏—Å–∞–Ω–∏–µ                                           |
| ----------------------- | -------------------------------------------------- |
| `npm run dev`           | –ó–∞–ø—É—Å–∫ –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (—Å nodemon –∏ .env.dev)  |
| `npm run build`         | –°–±–æ—Ä–∫–∞ TypeScript-–∫–æ–¥–∞ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é `dist/`        |
| `npm run start`         | –ó–∞–ø—É—Å–∫ production-–≤–µ—Ä—Å–∏–∏ –∏–∑ `dist/index.js`        |
| `npm run test`          | –ó–∞–ø—É—Å–∫ unit-—Ç–µ—Å—Ç–æ–≤ (Vitest)                        |
| `npm run test:coverage` | –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ —Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π –æ—Ç—á—ë—Ç–∞ –æ –ø–æ–∫—Ä—ã—Ç–∏–∏       |
| `npm run lint`          | –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞ —Å –ø–æ–º–æ—â—å—é ESLint                     |
| `npm run lint:fix`      | –ê–≤—Ç–æ–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫ –ª–∏–Ω—Ç–µ—Ä–∞                     |
| `npm run lint:format`   | –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ —Å –ø–æ–º–æ—â—å—é Prettier             |

---

## ü©∫ Healthcheck

–°–µ—Ä–≤–∏—Å –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–ª—è –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤:

- **Liveness**: `GET /health/live` ‚Äî –ø—Ä–æ—Ü–µ—Å—Å –∂–∏–≤ (–≤—Å–µ–≥–¥–∞ 200).
- **Readiness**: ` `GET /health/ready` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ RabbitMQ (200/503).

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤ `livenessProbe` / `readinessProbe` Kubernetes.

---

## üìä –ù–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç—å

- **–õ–æ–≥–∏**: —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ, –≤ —Ñ–æ—Ä–º–∞—Ç–µ OpenTelemetry (`stdout`).
- **–ú–µ—Ç—Ä–∏–∫–∏**: `notifications_retry_routing_total` —Å –º–µ—Ç–∫–æ–π `retry_queue`.
- **–¢—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞**: –æ—Ç–∫–ª—é—á–µ–Ω–∞ (—Ñ–æ–Ω–æ–≤—ã–π —Å–µ—Ä–≤–∏—Å –±–µ–∑ —Ü–µ–ø–æ—á–∫–∏ –≤—ã–∑–æ–≤–æ–≤).

> üìâ –í—Å–µ —Å–æ–±—ã—Ç–∏—è —Ç–µ–ª–µ–º–µ—Ç—Ä–∏–∏ –º–æ–∂–Ω–æ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ OpenTelemetry Collector.

---

## üê≥ Docker

–°–µ—Ä–≤–∏—Å –º–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –≤ Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ.  
–ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Å–±–æ—Ä–∫–µ –∏ –∑–∞–ø—É—Å–∫—É ‚Äî –≤ [docs/docker.md](./docs/docker.md).

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](./docs/architecture/architecture.md)
- [–°–æ–≥–ª–∞—à–µ–Ω–∏—è –ø–æ –∫–æ–¥—É](./docs/guideline.md)
- [ADR (Architectural Decision Records)](./docs/adr/)

---

> ‚ú® –°–µ—Ä–≤–∏—Å —Å–ª–µ–¥—É–µ—Ç –ø—Ä–∏–Ω—Ü–∏–ø–∞–º —á–∏—Å—Ç–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã, —è–≤–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏ –æ—Ç–∫–∞–∑–∞ –æ—Ç –º–∞–≥–∏–∏.  
> –í—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã, –≤—Å—ë –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `.env`, –≤—Å—ë –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è –∏ —Ç–µ–ª–µ–º–µ—Ç—Ä–∏—Ä—É–µ—Ç—Å—è.